---
title: localhost是怎么回事？
date: 2025-10-21 23:00:00-0800
category: 杂谈
tags:
  - 互联网
excerpt: 我们在本地预览项目时经常看到localhost，那么，localhost到底是怎么工作的呢？
---

当你创建了一个项目，准备在本地预览它的时候，经常会看到弹出这样一个网址：
`http://localhost:4000`

这时候你可能会冒出几个问题：
- 为什么我运行服务之后，打开这个网址就能看到我的项目？
- 为什么别人访问同样的地址，看到的却和我不一样？
- 为什么我不启动服务，这个页面就什么都显示不出来？

别急，这篇文章就带你彻底搞懂 `localhost` 背后的原理。

# 一点背景：网址是怎么来的？
在深入 `localhost` 之前，我们先简单回顾一下网址的历史。早期的互联网并没有像今天这样方便的域名系统。每台电脑里都有一个叫做 `hosts` 的文件，里面记录着一堆 IP 地址和对应网站的名称。那时候，如果你想访问某个网站，就得靠专人维护这个列表，再分发给每台电脑更新。

这种方式显然非常麻烦，后来才逐渐演变成我们今天所使用的 DNS（域名系统）——也就是输入 `google.com` 就能访问谷歌，而不需要记住它的 IP 地址。

# localhost 的 IP 是什么？

localhost 对应一个特殊的 IP 地址：`127.0.0.1`（IPv6 是 `::1`）。这个地址和其他所有 IP 都不同，它被称为**环回地址**。

这具体是怎么工作的呢？比如你在本地写了一个网站想看看效果，运行服务时，浏览器向服务器发送的数据就像一个“包裹”。通常，这个“包裹”会通过网卡发到外部网络。但如果目的地是 `127.0.0.1`，操作系统网络栈看到这个特殊地址，就会立刻把这个“包裹”**直接环回到本机**，根本不会送到外部网络。这也就是为什么别人访问他们自己的 `localhost` 看到的内容和你不一样——他们访问的其实是他们自己的电脑。

那么，浏览器又是怎么知道 `localhost` 就对应 `127.0.0.1` 或 `::1` 的呢？答案就在我们之前提到的 `hosts` 文件里。你的操作系统里就有这个文件，其中通常已经写好了这两行：
```text
127.0.0.1   localhost
::1         localhost
```
当浏览器解析 `localhost` 这个域名时，它会先来读取这个本地文件。一看到这两行，它就明白了：“原来 `localhost` 就是 `127.0.0.1` 啊！” 然后它又发现：“这个 IP 是个环回地址” 于是，它发起的请求就被直接“环回”到本机进行处理了。

{% note info %}
`localhost` 是一个被标准保留的特殊域名，任何人都无法在互联网上注册它。
{% endnote %}

# 服务器与浏览器怎么对接？

## 数据包去哪了？

你的操作系统内部有一个“虚拟网络接口”，在 Windows 上它被称为 `Loopback Adapter`，在 Mac/Linux 上则通常是 `lo`。

这个虚拟接口有什么用呢？我们之前说，发往 `localhost` 的请求会被“环回”到本机，实际上就是转给了这个虚拟接口。所有目标为环回地址的网络数据包，都会由这个接口接收和处理，它就像一个内部的虚拟网卡，确保数据在电脑内部高效流转。

## 连接如何建立？

整个过程可以这样理解：
1.  你启动了一个 Web 服务器，它开始在端口 4000 上监听请求（它的地址就是 `localhost:4000`）。
2.  当你在浏览器输入 `http://localhost:4000` 时，浏览器查询 `hosts` 文件，得知 `localhost` 就是 `127.0.0.1`。
3.  浏览器尝试向 `127.0.0.1:4000` 发起连接。操作系统识别出这是环回地址，便将这个连接请求直接交给虚拟环回接口。
4.  环回接口将请求递交给正在监听 `127.0.0.1:4000`（或 `0.0.0.0:4000`）的服务器进程。
5.  服务器接受连接，并开始向浏览器发送网页数据（如 HTML、CSS）。
6.  浏览器接收到数据，进行渲染，你就看到了你的网站界面。

# 结语
`localhost`最主要的功能就是**开发与测试**，让开发者快速看到自己网站的成效。而且它只在**本机**建立连接，所以还有很高的**安全性**。是网络世界不可或缺的一部分呢。
